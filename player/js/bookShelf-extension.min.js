"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6526],{52539:(e,t,o)=>{const{registerReducer:r,registerEpics:a}=o(90876),n=o(6443),i=o(20319),{bookShelfSetupEpic:l,registerTrackingMapEpic:s,saveTrackingEpic:c}=o(44405);r("bookShelf",i),a(l,s,c,n("bookShelf"))},24109:(e,t,o)=>{const r=o(90882),a=o(16760),n=o(58335),i=o(13980),l=o(2784),{connect:s}=o(57903),c=o(72779),h=o(11865),d=o(11533),p=o(50085),b=o(72489),S=o(60402),_=o(615),{ContentContainer:u,HeroImage:m}=o(20077),v=o(86587),E=n({displayName:"BookShelf",propTypes:{bookShelf:i.shape({title:i.string,body:i.string,noItemsText:i.string,ariaLabel:i.string,_headerIcon:i.string,_heroImage:i.object}).isRequired,articles:i.array.isRequired,theme:i.object.isRequired,isReady:i.bool.isRequired},renderTitle(){if(this.props.bookShelf.title)return l.createElement(d,{headingElement:`h${this.context}`,displayTitle:this.props.bookShelf.title,className:"ev-header-title",innerClassName:"ev-header-title-inner"})},renderBody(){if(this.props.bookShelf.body)return l.createElement(h,{className:"ev-header-body",innerClassName:"ev-header-body-inner",body:this.props.bookShelf.body})},renderNoItems(){const{bookShelf:e,articles:t}=this.props;if(!t.length)return l.createElement(b,null,l.createElement(h,{className:"ev-component-body",innerClassName:"ev-component-body-inner",body:e.noItemsText}))},renderArticles(){const{articles:e}=this.props;return e.length?a(e,(e=>l.createElement(S,{key:e._id,articleId:e._id}))):null},renderHeroImage(){const{_heroImage:e}=this.props.bookShelf;if(null!=e&&e._isEnabled)return l.createElement(v.Provider,{value:this.props.bookShelf.title?this.context+1:this.context},l.createElement(m,{title:e.title,body:e.body,graphic:e._graphic,_contentWidth:e._contentWidth,layout:e.layout,floatingGraphic:e._floatingGraphic,parentSelector:".ev-extension-hero-container",theme:this.props.theme,isReady:this.props.isReady}))},render(){var e,t,o,r;const{bookShelf:a,theme:n,isReady:i}=this.props,s=a._headerIcon,h=null===(e=n._extensions._bookShelf)||void 0===e||null===(t=e._settings)||void 0===t?void 0:t._headerIcon,d=s||h,b=a.title||null!==(o=a._heroImage)&&void 0!==o&&o._isEnabled&&null!==(r=a._heroImage)&&void 0!==r&&r.title?this.context+1:this.context;return l.createElement(u,{region:"bookshelf",className:"ev-extension ev-bookShelf",ariaLabel:a.ariaLabel},l.createElement("div",{className:"ev-extension-inner"},i?null:l.createElement(_,null),l.createElement("div",{className:"ev-extension-hero-container"},this.renderHeroImage()),l.createElement("div",{className:"ev-header"},l.createElement("div",{className:c("ev-header-inner ev-clearfix",{"ev-no-graphic":!d})},l.createElement("div",{className:"ev-header-left"},this.renderTitle(),this.renderBody()),d&&l.createElement("div",{className:"ev-header-right"},l.createElement(p,{icon:d})))),l.createElement(v.Provider,{value:b},this.renderNoItems(),this.renderArticles())))}});E.contextType=v,e.exports=s((e=>({bookShelf:e.bookShelf,theme:e.theme,isReady:e.location.isLocationReady,articles:r(e.articles,(({_bookShelf:e})=>(null==e?void 0:e._isEnabled)&&(null==e?void 0:e._isShelved)))})))(E)},99384:(e,t,o)=>{const r=o(58335),a=o(2784),{connect:n}=o(57903),i=o(72779),{updateArticle:l}=o(88072),s=r({displayName:"BookShelfArticleButton",onClick(e){e.preventDefault();const{article:t}=this.props;let o=t._bookShelf._isShelved;o=!o,this.props.updateArticle({_id:t._id,_bookShelf:{...t._bookShelf,_isShelved:o}})},render(){var e;const{article:t}=this.props;if(null==t||null===(e=t._bookShelf)||void 0===e||!e._isEnabled)return null;const o=t._bookShelf._isShelved;return a.createElement("div",{className:"ev-article-action-bar-item"},a.createElement("button",{className:"ev-button ev-chromeless",onClick:this.onClick,"aria-label":this.props.ariaLabel,"aria-pressed":o},a.createElement("i",{className:i("ev-icon",{"ev-icon-bookmark":o,"ev-icon-book2":!o})})))}});e.exports=n(null,{updateArticle:l})(s)},44405:(e,t,o)=>{const r=o(72579),{Observable:a}=o(28761),{registerTrackingMap:n}=o(90876),{SETUP_APP:i}=o(63444),{addElement:l}=o(51777),{NavigationSideItem:s}=o(39819),c=o(98471),{UPDATE_ARTICLE:h}=o(88072),{trackerSaveSession:d}=o(63062),p=o(99384),b=o(24109),S=o(28593);t.bookShelfSetupEpic=(e,t)=>e.filter((e=>{var o;const r=t.getState();return e.type===i&&(null==r||null===(o=r.bookShelf)||void 0===o?void 0:o._isEnabled)})).mergeMap((()=>{const e=t.getState(),{bookShelf:o}=e,n=l({parent:"navigationSide",name:"bookShelf",component:s,props:{link:"/bookShelf",icon:c("_bookShelf","_navigationIcon","bookmark"),label:o.title}}),i=l({parent:"article",name:"bookShelf",component:p,position:"actionBar",props:{ariaLabel:o.shelveButtonAriaLabel}}),h=l({parent:"router",name:"bookShelf",path:"/bookShelf",exact:!0,component:b,getShouldPersist:e=>r(e,"course._bookShelf._isEnabled",!1)});return a.of(n,i,h)})),t.registerTrackingMapEpic=(e,t)=>e.filter((e=>{if(e.type!==i)return!1;const{bookShelf:o}=t.getState();return o&&o._isEnabled})).do((()=>{n("bookShelf",S,"extensions")})).ignoreElements(),t.saveTrackingEpic=(e,t)=>e.filter((e=>{var o;return e.type===h&&(null===(o=t.getState().bookShelf)||void 0===o?void 0:o._isEnabled)&&e.payload._bookShelf})).mergeMap((()=>a.of(d())))},20319:(e,t,o)=>{const r=o(60019),{SETUP_APP:a}=o(63444),n={_isEnabled:!1};e.exports=(e=n,t)=>{if(t.type===a){const o=t.payload.course._bookShelf;return o&&o._isEnabled?r({},e,o):n}return e._isEnabled?(t.type,e):n}},28593:(e,t,o)=>{const r=o(79421),{store:a}=o(90876),{updateArticle:n}=o(88072);e.exports={_articles:{fieldKey:"_articles",type:"Function",shouldRestore:!0,mapCallback:function(){const{articles:e}=a.getState(),t={};return r(e,(e=>{var o;null!=e&&null!==(o=e._bookShelf)&&void 0!==o&&o._isEnabled&&(t[e._id]={_isShelved:e._bookShelf._isShelved})})),t},restoreCallback:function(e){const{articles:t}=a.getState();r(e._articles,((e,o)=>{const r=t[o];r&&a.dispatch(n({_id:o,_bookShelf:{...null==r?void 0:r._bookShelf,...e}}))}))}}}},63062:(e,t)=>{t.TRACKER_LOAD_DATA="TRACKER_LOAD_DATA",t.TRACKER_SAVE_SESSION="TRACKER_SAVE_SESSION",t.SET_TRACKER_AUTH="SET_TRACKER_AUTH",t.SAVE_TRACKER_DONE="SAVE_TRACKER_DONE",t.trackerLoadData=e=>({type:t.TRACKER_LOAD_DATA,payload:e}),t.trackerSaveSession=e=>({type:t.TRACKER_SAVE_SESSION,payload:e}),t.setTrackerAuth=e=>({type:t.SET_TRACKER_AUTH,payload:e}),t.saveTrackingDone=e=>({type:t.SAVE_TRACKER_DONE,payload:e})},98471:(e,t,o)=>{const r=o(72579),{store:a}=o(90876);e.exports=function(e,t,o){const{course:n,theme:i}=a.getState(),l=n[e],s=r(l,t),c=r(i,["_extensions",e,"_settings",t]);return s||c||o}},6443:(e,t,o)=>{const r=o(72579),{Observable:a}=o(28761),{setLocationReadyState:n,PUSH_LOCATION:i}=o(63444),l=o(36151),s=o(69610);e.exports=(e,t)=>(o,c)=>o.filter((({type:t})=>{if(t!==i)return;const{navigationStatus:o,path:r}=c.getState().location;return"plugin"===o&&r[0]===e})).switchMap((()=>{const o=c.getState(),{device:i,course:h}=o;let d;if(d=t?t(o):r(h,[`_${e}`,"_heroImage"]),!d||!d._graphic)return a.empty();const p=l(d._graphic.src,d._graphic.srcAdvanced,!0);return p?a.concat(a.of(n(!1)),a.bindCallback(s)(p,!1).map((()=>n(!0)))):a.empty()}))}}]);