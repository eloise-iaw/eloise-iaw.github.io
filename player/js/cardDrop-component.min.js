"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8343],{19352:(e,t)=>{t.CARD_DROP_ON_DROP="CARD_DROP_ON_DROP",t.CARD_DROP_ON_DROP_REJECT="CARD_DROP_ON_DROP_REJECT",t.CARD_DROP_ON_DROP_POST_REJECT="CARD_DROP_ON_DROP_POST_REJECT",t.CARD_DROP_ON_NEXT_CARD="CARD_DROP_ON_NEXT_CARD",t.onCardDrop=e=>({type:t.CARD_DROP_ON_DROP,payload:e}),t.onCardDropReject=e=>({type:t.CARD_DROP_ON_DROP_REJECT,payload:e}),t.onCardDropPostReject=e=>({type:t.CARD_DROP_ON_DROP_POST_REJECT,payload:e}),t.onNextCard=e=>({type:t.CARD_DROP_ON_NEXT_CARD,payload:e})},64361:(e,t,o)=>{const{registerComponent:r}=o(90876),n=o(33760),i=o(39638),{onCardDrop:s,onCardDropReject:c,onCardDropPostReject:d,onNextCard:a}=o(19352);r("cardDrop",{component:n,actions:{onCardDrop:s,onCardDropReject:c,onCardDropPostReject:d,onNextCard:a},reducer:i,trackingMap:o(71665)})},33760:(e,t,o)=>{const r=o(98923),n=o(90882),i=o(55281),s=o(16760),c=o(58335),d=o(13980),a=o(2784),{Component:p}=o(58720),l=o(96235),_=o(89493),u=o(88934),m=o(43855),h=o(80804),C=o(27664),b=o(36616),R=c({displayName:"CardDrop",propTypes:{component:d.object.isRequired,styles:d.object,screenSize:d.string.isRequired,submitQuestion:d.func.isRequired,actionButtonClicked:d.func.isRequired,setComponentAsReady:d.func.isRequired,setComponentAsViewed:d.func.isRequired,showFeedback:d.func.isRequired,shouldHideMarking:d.bool,onCardDrop:d.func.isRequired,onCardDropReject:d.func.isRequired,onCardDropPostReject:d.func.isRequired,onNextCard:d.func.isRequired},componentDidMount(){this.props.setComponentAsReady(this.props.component._id)},componentDidUpdate(e){const{component:t}=this.props;!e.component._isSubmitted&&t._isSubmitted&&this.showFeedback()},UNSAFE_componentWillReceiveProps(e){!this.props.component._canSubmit&&e.component._canSubmit&&this.props.submitQuestion(this.props.component._id)},getActionButtonEnabled(){const{_isSubmitted:e,_isCorrect:t,_attemptsLeft:o}=this.props.component;return e&&!t&&o>0},showFeedback(){const e=_(this.props.component);this.props.showFeedback(e)},onVisibilityChange(...e){m(...e,this,this.props.setComponentAsViewed)},onDrop(e){const{onCardDrop:t,onNextCard:o,component:n}=this.props,i=n._id;t({componentId:i,zoneId:e}),r((()=>o({componentId:i})),1e3)},onDropReject(e){const{onCardDropReject:t,onCardDropPostReject:o,component:n}=this.props,i=n._id;t({componentId:i,zoneId:e}),r((()=>o({componentId:i})),1e3)},renderCardDropItems(e){const{_id:t,_items:o,_currentItemId:r}=this.props.component;if(!r)return;let i=n(o,{_isComplete:!1,_isRejected:!1});return i=i.slice(0,5),s(i,((n,i)=>a.createElement(h,{key:n._id,id:n._id,componentId:t,isCurrentItem:r===n._id,index:i,zIndex:o.length-i,text:n.text,width:e.width,height:e.height,canFocus:n._canFocus})))},renderDropZones(e){const{_items:t,_currentItemId:o}=this.props.component,r=i(t,{_id:o});if(!r)return;const{_id:n,_dropZones:c,_shouldZonesRejectIncorrect:d,_useComponentDropZones:p,_isComplete:l,rejectedCardAriaLabel:_}=this.props.component,u=p?c:r._dropZones;return s(u,(t=>a.createElement(C,{key:`${o}-${t._id}-${r._isComplete}`,id:t._id,componentId:n,isComponentComplete:l,text:t.text,ariaLabel:t.ariaLabel,rejectedCardAriaLabel:_,isComplete:r._isComplete,isRejected:r._isRejected,isCorrectZone:p?r._correctDropZoneIds.includes(t._id):t.isCorrectZone,rejectIncorrect:d,hasDroppedItem:r._droppedZoneId===t._id||r._isRejected&&r._droppedZoneId===t._id,currentItemText:r.text,width:e.width,height:e.height,onDrop:this.onDrop,onDropReject:this.onDropReject})))},renderIndicator(){const{component:e,shouldHideMarking:t}=this.props;if(e._isComplete&&!t)return a.createElement(b,{items:e._items,indicatorLabelText:e.indicatorLabelText,shouldHideScore:e._shouldHideScore})},render(){const{props:e}=this,t=e.component._cardSizes[e.screenSize],{width:o,height:r}=t;return a.createElement(p,{component:e.component,styles:e.styles,shouldHideMarking:e.shouldHideMarking,shouldHideActionButton:e.component._attempts<=1,onActionButtonClicked:e.actionButtonClicked,isVisibilitySensorActive:u(e),onVisibilityChange:this.onVisibilityChange,onFeedbackButtonClicked:this.showFeedback,getActionButtonState:()=>"reset",getActionButtonEnabled:this.getActionButtonEnabled},a.createElement("div",{className:l(e.component)},a.createElement("div",{className:"ev-card-drop-items",style:{width:`${o}px`,height:`${r}px`}},this.renderCardDropItems(t)),a.createElement("div",{className:"ev-card-drop-zones"},this.renderDropZones(t)),this.renderIndicator()))}});e.exports=R},36616:(e,t,o)=>{const r=o(90882),n=o(16760),i=o(13980),s=o(2784),c=o(50085),d=({items:e,indicatorLabelText:t,shouldHideScore:o})=>s.createElement("div",{className:"ev-card-drop-indicator"},s.createElement("div",{className:"ev-card-drop-indicator-items"},n(e,(e=>s.createElement("div",{key:e._id,className:"ev-card-drop-indicator-item"},s.createElement(c,{icon:e._isCorrect?"check":"cross"}))))),o?null:s.createElement("div",{className:"ev-label ev-card-drop-indicator-label"},(()=>{const o=r(e,{_isCorrect:!0});return`${t} ${o.length}/${e.length}`})()));d.propTypes={items:i.array.isRequired,indicatorLabelText:i.string,shouldHideScore:i.bool},d.defaultProps={indicatorLabelText:"",shouldHideScore:!1},e.exports=d},80804:(e,t,o)=>{const r=o(58335),n=o(13980),i=o(2784),s=o(28316),c=o(90212),d=o(72779),a=o(50085),p=o(11865),l=r({displayName:"CardDropItem",propTypes:{id:n.string.isRequired,componentId:n.string.isRequired,text:n.string,isCurrentItem:n.bool.isRequired,zIndex:n.number.isRequired,index:n.number.isRequired,width:n.number.isRequired,height:n.number.isRequired,canFocus:n.bool.isRequired},getDefaultProps:()=>({width:300,height:150,canFocus:!1}),getInitialState:()=>({_isDragging:!1,_x:0,_y:0}),componentDidMount(){const{isCurrentItem:e,canFocus:t}=this.props;this._isMounted=!0,this._interact=c(s.findDOMNode(this)).draggable({onmove:this.onDragMove,onend:this.onDragEnd,enabled:e,autoScroll:!0,modifiers:[c.modifiers.restrict({restriction:".ev-cardDrop-widget"})]}),t&&this._button.focus({preventScroll:!0})},componentWillUnmount(){this._isMounted=!1,this._interact.unset()},componentDidUpdate({isCurrentItem:e,canFocus:t}){const{isCurrentItem:o,canFocus:r}=this.props;o&&!e&&(this._interact=this._interact.draggable(!0)),r&&!t&&this._button.focus({preventScroll:!0})},onDragMove(e){this.setState({_x:this.state._x+e.dx,_y:this.state._y+e.dy,_isDragging:!0})},onDragEnd(){this._isMounted&&this.setState({_isDragging:!1,_x:0,_y:0})},getStyle(){const{width:e,height:t,zIndex:o,index:r}=this.props,{_x:n,_y:i}=this.state;return{left:`${n}px`,top:`${i}px`,transform:`translateY(${r*(window.innerWidth<520?1:2)}%)`,position:"absolute",width:`${e}px`,height:`${t}px`,zIndex:o}},render(){const{text:e,isCurrentItem:t,id:o,componentId:r}=this.props,{_isDragging:n}=this.state;return i.createElement("button",{id:o,ref:e=>this._button=e,className:d("ev-card-drop-item ev-focusable",`ev-card-drop-item-${r}`,{"ev-is-current-item":t,"ev-is-dragging":n,"ev-is-disabled":!t}),style:this.getStyle(),tabIndex:t?0:-1},i.createElement(p,{tag:"span",innerTag:"span",body:e}),i.createElement(a,{className:"ev-card-drop-item-drag-icon",icon:"move"}))}});e.exports=l},27664:(e,t,o)=>{const r=o(58335),n=o(13980),i=o(2784),s=o(28316),c=o(90212),d=o(72779),{isEnterKey:a}=o(28739),p=o(11865),l=o(21247),_=r({displayName:"CardDropZone",propTypes:{id:n.string.isRequired,componentId:n.string.isRequired,isComponentComplete:n.bool.isRequired,text:n.string,ariaLabel:n.string,rejectedCardAriaLabel:n.string,onDrop:n.func.isRequired,onDropReject:n.func.isRequired,currentItemText:n.string,isComplete:n.bool.isRequired,isRejected:n.bool.isRequired,isCorrectZone:n.bool.isRequired,rejectIncorrect:n.bool.isRequired,width:n.number.isRequired,height:n.number.isRequired,hasDroppedItem:n.bool.isRequired},getDefaultProps:()=>({isComponentComplete:!1,isComplete:!1,isRejected:!1,isCorrectZone:!1,rejectIncorrect:!1,width:300,height:150,hasDroppedItem:!1}),getInitialState:()=>({_isFocused:!1,_isDragOver:!1}),componentDidMount(){c(s.findDOMNode(this)).dropzone({accept:`.ev-card-drop-item-${this.props.componentId}`,ondrop:this.onDrop,ondragenter:this.onDragEnter,ondragleave:this.onDragLeave,overlap:.5})},componentWillUnmount(){c(s.findDOMNode(this)).unset()},onDrop(){const{id:e,onDrop:t,onDropReject:o,isCorrectZone:r,rejectIncorrect:n}=this.props;if(n&&!r)return o(e),this.onDragLeave();t(e)},onDragEnter(){this.setState({_isDragOver:!0})},onDragLeave(){this.setState({_isDragOver:!1})},onFocus(){this.setState({_isFocused:!0})},onBlur(){this.setState({_isFocused:!1})},onKeyDown(e){const{_isFocused:t}=this.state,{id:o,onDrop:r,onDropReject:n,isComplete:i,isCorrectZone:s,rejectIncorrect:c}=this.props;if(a(e))return c&&!s?n(o):void(t&&!i&&r(o))},onClick(){const{id:e,onDrop:t,onDropReject:o,isComplete:r,isCorrectZone:n,rejectIncorrect:i}=this.props;if(i&&!n)return o(e);r||t(e)},renderCardItem(){const{currentItemText:e,isComplete:t,isRejected:o,hasDroppedItem:r,width:n,height:s,rejectedCardAriaLabel:c,isComponentComplete:d}=this.props;if(!d&&(t||o)&&r)return i.createElement(l,{text:e,width:n,height:s,isRejected:o,rejectedCardAriaLabel:c})},render(){const{text:e,ariaLabel:t,width:o,height:r,isComplete:n,isRejected:s}=this.props,{_isDragOver:c}=this.state;return i.createElement("div",{className:d("ev-card-drop-zone",{"ev-is-drag-over":c,"ev-is-disabled":n,"ev-is-rejected":s}),tabIndex:n?null:0,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onClick:this.onClick,"aria-label":t,style:{width:`${o}px`,height:`${r}px`}},i.createElement(p,{tag:"span",innerTag:"span",body:e}),this.renderCardItem())}});e.exports=_},21247:(e,t,o)=>{const r=o(58335),n=o(13980),i=o(2784),s=o(72779),c=o(11865),d=r({displayName:"CardDropZoneItem",propTypes:{text:n.string,rejectedCardAriaLabel:n.string,width:n.number.isRequired,height:n.number.isRequired,isRejected:n.bool.isRequired},componentDidMount(){const{isRejected:e}=this.props;e&&this._button.focus({preventScroll:!0})},render(){const{text:e,rejectedCardAriaLabel:t,width:o,height:r,isRejected:n}=this.props;return i.createElement("button",{ref:e=>this._button=e,className:s("ev-card-drop-item ev-card-drop-drop-zone-item ev-is-disabled ev-focusable",{"ev-is-rejected":n}),style:{width:`${o}px`,height:`${r}px`},tabIndex:"-1","aria-label":n?t:null,"aria-hidden":!n},i.createElement(c,{tag:"span",innerTag:"span",body:e}))}});e.exports=d},39638:(e,t,o)=>{const r=o(90882),n=o(55281),i=o(16760),{SETUP_COMPONENT:s,RESET_QUESTION:c,SUBMIT_QUESTION:d}=o(29933),{CARD_DROP_ON_DROP:a,CARD_DROP_ON_DROP_REJECT:p,CARD_DROP_ON_DROP_POST_REJECT:l,CARD_DROP_ON_NEXT_CARD:_}=o(19352);function u(e){let t={};if(!e._isComplete){const o=i(e._items,(e=>({...e,_isComplete:!1,_isRejected:!1,_isCorrect:!1,_canFocus:!1})));t={_currentItemId:o.length?o[0]._id:null,_items:o,_canSubmit:!1}}return{...e,...t,_shouldDisableShowAnswer:!0}}function m(e,t,o){return o?e._correctDropZoneIds.includes(t):n(e._dropZones,{_id:t}).isCorrectZone}e.exports=function(e,t){switch(t.type){case s:return u(e);case d:return function(e){const{_items:t,_canSubmit:o}=e;if(!o)return e;const n=r(t,{_isCorrect:!0}).length,i=n===t.length,s=!i&&n>0;return{...e,_isCorrect:i,_isPartlyCorrect:s,_hasUserAnswered:!0}}(e);case c:return function(e){const t=u(e);return{...e,...t,_items:i(t._items,(e=>t._currentItemId===e._id?{...e,_canFocus:!0}:e))}}(e);case a:return function(e,t){const{_items:o,_currentItemId:r,_useComponentDropZones:s}=e,c=i(o,(e=>r===e._id?{...e,_isComplete:!0,_isCorrect:m(e,t,s),_droppedZoneId:t}:e)),d=n(c,{_isComplete:!1});return d&&(d._canFocus=!0),{...e,_items:c}}(e,t.payload.zoneId);case p:return function(e,t){const{_items:o,_currentItemId:r}=e;return{...e,_items:i(o,(e=>r===e._id?{...e,_isRejected:!0,_droppedZoneId:t}:e))}}(e,t.payload.zoneId);case l:return function(e){const{_items:t,_currentItemId:o}=e;return{...e,_items:i(t,(e=>o===e._id?{...e,_canFocus:!0,_isRejected:!1}:e))}}(e,t.payload.zoneId);case _:return function(e){const{_items:t,_currentItemId:o}=e,i=n(t,{_isComplete:!1}),s=i?i._id:o;return{...e,_currentItemId:s,_canSubmit:r(t,{_isComplete:!0}).length===t.length}}(e);default:return e}}},71665:e=>{e.exports={_interactionType:{type:"String",default:"question",shouldRestore:!1},_attemptsLeft:{fieldKey:"_attemptsLeft",type:"Number",shouldRestore:!0},_attemptsTaken:{fieldKey:"_attemptsTaken",type:"Number",shouldRestore:!0},_items:{fieldKey:"_items",type:"Array",shouldRestore:!0,subMap:{_id:{fieldKey:"_id",type:"String"},_isCorrect:{fieldKey:"_isCorrect",type:"String",shouldRestore:!0},_droppedZoneId:{fieldKey:"_droppedZoneId",type:"String",shouldRestore:!0}}},_hasUserAnswered:{fieldKey:"_hasUserAnswered",type:"Boolean",shouldRestore:!0}}},89493:(e,t,o)=>{const{store:r}=o(90876),n=o(96075);function i(e,t,o){const i=e._feedback[o],s=n(i);return t&&!s?r.getState().course._globals._feedbackText[o]:s?i:null}function s(e,t){const o=e._feedbackNavigation;if(o&&o[t]&&o[t]._isEnabled&&o[t]._linkType)return{_link:o[t]}}e.exports=function(e){let t;return t=e._isCorrect?function(e){const t=e._feedback._shouldUseGlobalCorrectFeedback;return{feedbackMessage:(t?r.getState().course._globals._feedbackText.correctFeedback:"")+(e._feedback.correct?e._feedback.correct:""),feedbackGraphic:i(e,t,"_correctGraphic"),feedbackNavigation:s(e,"_correct")}}(e):e._isPartlyCorrect?function(e){const{_partlyCorrect:t}=e._feedback,o=t._shouldUseGlobalPartlyCorrectFeedback,n=r.getState().course._globals._feedbackText;return 0===e._attemptsLeft?{feedbackMessage:(o?n.partlyCorrectFinalFeedback:"")+(t.final||""),feedbackGraphic:i(e,o,"_partlyCorrectFinalGraphic"),feedbackNavigation:s(e,"_partlyCorrect")}:{feedbackMessage:(o?n.partlyCorrectNotFinalFeedback:"")+(t.notFinal||""),feedbackGraphic:i(e,o,"_partlyCorrectNotFinalGraphic"),feedbackNavigation:s(e,"_partlyCorrectNotFinal")}}(e):function(e){const{_incorrect:t}=e._feedback,o=t._shouldUseGlobalIncorrectFeedback,n=r.getState().course._globals._feedbackText;return 0===e._attemptsLeft||!t.notFinal&&!o||!n.incorrectNotFinalFeedback&&o?{feedbackMessage:(o?n.incorrectFinalFeedback:"")+(t.final||""),feedbackGraphic:i(e,o,"_incorrectFinalGraphic"),feedbackNavigation:s(e,0===e._attemptsLeft?"_incorrect":"_incorrectNotFinal")}:{feedbackMessage:(o?n.incorrectNotFinalFeedback:"")+(t.notFinal||""),feedbackGraphic:i(e,o,"_incorrectNotFinalGraphic"),feedbackNavigation:s(e,"_incorrectNotFinal")}}(e),!1!==e._shouldShowDisplayTitleInFeedback&&(t.feedbackTitle=e.displayTitle),t}},88934:e=>{e.exports=(e,t="_hasBeenViewed")=>{const{component:o,isPageReady:r}=e;return!0===r&&!0===o._isReady&&!0!==o[t]}},96235:(e,t,o)=>{const r=o(72779);e.exports=function(e){return r(`ev-${e._component}-widget ev-component-widget ev-clearfix`,{"ev-disabled":!e._isEnabled,"ev-complete ev-show-user-answer":e._isComplete&&!e._isEnabled,"ev-correct":e._isCorrect&&!e._isEnabled,"ev-submitted":e._isSubmitted})}},43855:e=>{e.exports=function(e,t,o,r,n){r&&r.props&&r.props.component?(t.top&&(r.isInviewTop=!0),t.bottom&&(r.isInviewBottom=!0),r.isInviewTop&&r.isInviewBottom&&n&&n(r.props.component._id)):console.error("No component reference passed to helpers/visibilityChangeHandler")}}}]);