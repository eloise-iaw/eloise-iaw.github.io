"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4712],{85762:(e,t,n)=>{const o=n(58335),i=n(13980),r=n(2784),{connect:a}=n(57903),s=n(72779),c=n(11865),l=n(11533),m=n(50085),p=n(72489),{ContentContainer:u,HeroImage:d}=n(20077),_=n(615),h=n(86587),g=o({displayName:"CourseAttainment",propTypes:{courseAttainment:i.shape({title:i.string,completionBody:i.string,ariaLabel:i.string,_heroImage:i.object,_headerIcon:i.string}).isRequired,theme:i.object.isRequired,isReady:i.bool.isRequired},renderTitle(){if(this.props.courseAttainment.title)return r.createElement(l,{headingElement:`h${this.context}`,displayTitle:this.props.courseAttainment.title,className:"ev-course-attainment-header-title ev-header-title",innerClassName:"ev-course-attainment-header-title-inner ev-header-title-inner"})},renderContent(){if(this.props.courseAttainment.completionBody)return r.createElement(p,null,r.createElement(c,{className:"ev-component-body",innerClassName:"ev-component-body-inner",body:this.props.courseAttainment.completionBody}))},renderHeroImage(){const{_heroImage:e}=this.props.courseAttainment;if(null!=e&&e._isEnabled)return r.createElement(h.Provider,{value:this.props.courseAttainment.title?this.context+1:this.context},r.createElement(d,{title:e.title,body:e.body,graphic:e._graphic,_contentWidth:e._contentWidth,layout:e.layout,floatingGraphic:e._floatingGraphic,parentSelector:".ev-extension-hero-container",theme:this.props.theme,isReady:this.props.isReady}))},render(){var e,t;const{courseAttainment:n,theme:o,isReady:i}=this.props,a=n._headerIcon,c=null===(e=o._extensions._courseAttainment)||void 0===e||null===(t=e._settings)||void 0===t?void 0:t._headerIcon,l=a||c;return r.createElement(u,{region:"course attainment",className:"ev-extension ev-course-attainment",ariaLabel:n.ariaLabel},r.createElement("div",{className:"ev-course-attainment-inner ev-extension-inner"},i?null:r.createElement(_,null),r.createElement("div",{className:"ev-extension-hero-container"},this.renderHeroImage()),r.createElement("div",{className:"ev-header"},r.createElement("div",{className:s("ev-header-inner ev-clearfix",{"ev-no-graphic":!l})},r.createElement("div",{className:"ev-header-left"},this.renderTitle()),l&&r.createElement("div",{className:"ev-header-right"},r.createElement(m,{icon:l})))),this.renderContent()))}});g.contextType=h,e.exports=a((e=>({courseAttainment:e.courseAttainment,theme:e.theme,isReady:e.location.isLocationReady})))(g)},94691:(e,t,n)=>{const{registerReducer:o,registerEpics:i}=n(90876),r=n(6443),a=n(54476),{courseAttainmentSetupEpic:s,attainmentComponentCompletedEpic:c,attainmentAchievementComponentCompletedEpic:l,attainmentCompletionEpic:m,registerTrackingMapEpic:p,setVariableOnProgressChangedEpic:u}=n(61148);o("courseAttainment",a),i(s,c,l,m,p,u,r("courseAttainment"))},61148:(e,t,n)=>{const o=n(72579),i=n(60019),{Observable:r}=n(28761),{SETUP_APP:a}=n(63444),{COMPONENT_COMPLETED:s,UPDATE_COMPONENTS:c}=n(29933),{addElement:l}=n(51777),{addPrompt:m}=n(90672),{NavigationSideItem:p}=n(39819),{updateVariable:u}=n(66376),{trackableChange:d}=n(59828),_=n(98471),{registerTrackingMap:h}=n(90876),g=n(85762),{COURSE_ATTAINMENT_COMPONENT_COMPLETED:E,COURSE_ATTAINMENT_ACHIEVEMENTS_UPDATED:C,attainmentComponentCompleted:A,attainmentAchievementComponentCompleted:y,attainmentComplete:f}=n(66455),v=n(98113);t.courseAttainmentSetupEpic=(e,t)=>e.filter((e=>{const n=t.getState();if(e.type!==a)return!1;const{courseAttainment:o}=n;return o&&o._isEnabled&&o._isComplete&&!o._shouldHideSummaryAndIcon})).map((()=>{const e=t.getState(),{courseAttainment:n}=e;return l({parent:"navigationSide",name:"courseAttainment",component:p,props:{link:"/courseAttainment",icon:_("_courseAttainment","_navigationIcon","license2"),label:n.title}})})),t.registerTrackingMapEpic=(e,t)=>e.filter((e=>{const n=t.getState();if(e.type!==a)return!1;const{courseAttainment:o}=n;return o&&o._isEnabled})).do((()=>{h("courseAttainment",v,"extensions")})).ignoreElements(),t.attainmentComponentCompletedEpic=(e,t)=>e.filter((e=>{const n=t.getState();if(!n.app.isDataReady||e.type!==s)return!1;const{courseAttainment:o}=n;return o&&o._isEnabled})).map((()=>{const e=i({},t.getState());return e._prevIsComplete=e.courseAttainment._isComplete,A(e)})),t.attainmentAchievementComponentCompletedEpic=(e,t)=>e.filter((e=>{const n=t.getState();if(!n.app.isDataReady||"ACHIEVEMENTS_COMPONENT_COMPLETED"!==e.type)return!1;const{courseAttainment:o}=n;return o&&o._isEnabled})).map((()=>{const e=i({},t.getState());return e._prevIsComplete=e.courseAttainment._isComplete,y(e)})),t.setVariableOnProgressChangedEpic=(e,t)=>e.ofType(E,C,a,c).filter((()=>{const{app:e,courseAttainment:n,course:{_courseAttainment:o}}=t.getState();return e.hasAppStarted&&n._isEnabled&&(null==o?void 0:o._canSaveToVariable)&&o._variableId})).map((()=>Math.floor(t.getState().courseAttainment._progress))).distinctUntilChanged().map((e=>{const{course:{_courseAttainment:n}}=t.getState();return u(n._variableId,e,n._variableUpdateType)})),t.attainmentCompletionEpic=(e,t)=>e.ofType(E,C).mergeMap((e=>{const n=e.payload._prevIsComplete,{theme:i,courseAttainment:a}=t.getState();if(n!==a._isComplete&&a._isComplete){const e=[f(),d()];if(a._shouldHideNotificationPopup||e.push(m(function(e,t){let n={};e._shouldCloseWindowOnCourseAttained?(n={title:e.completionNotifyTitle,body:e.completionNotifyBody,_action:{text:e.closeWindowText,onClick:()=>{window._exitCourse()}}},e._shouldHidePromptDismissButton&&(n._dismiss={_isHidden:!0})):(n={title:e.completionNotifyTitle,body:e.completionNotifyBody},e._shouldHideSummaryAndIcon||(n._action={text:e.completionTitle,_link:{_link:"courseAttainment",_linkType:"extensions"}}));const i=o(e,"_notifyIcon"),r=o(t,"_extensions._courseAttainment._settings._notifyIcon"),a=i||r;return a&&(n._glyph={_type:"icon",_icon:a}),n}(a,i))),a._shouldHideSummaryAndIcon||(e.push(l({parent:"navigationSide",name:"courseAttainment",component:p,props:{link:"/courseAttainment",icon:_("_courseAttainment","_navigationIcon","license2"),label:a.title}})),e.push(l({parent:"router",name:"courseAttainment",path:"/courseAttainment",exact:!0,component:g}))),e.length)return r.of(...e)}return r.empty()}))},54476:(e,t,n)=>{const o=n(90882),i=n(39794),r=n(60019),{SETUP_APP:a}=n(63444),{RESTORE_EXTENSION:s}=n(59828),{COURSE_ATTAINMENT_COMPONENT_COMPLETED:c,COURSE_ATTAINMENT_ACHIEVEMENTS_UPDATED:l}=n(66455),m={_isComplete:!1,_progress:0,contentCount:0};function p(e,{components:t,blocks:n,achievements:r}){switch(e._attainmentMethod){case"components":return function({_shouldUseCorrectQuestions:e},t){const n=o(t,(e=>e._courseAttainment&&e._courseAttainment._isEnabled));if(!n.length)return!1;const i=o(n,(t=>!(!t._isComplete||e&&t._isQuestionType&&!t._isCorrect)));return{_isComplete:n.length===i.length,_progress:100/n.length*i.length,contentCount:n.length}}(e,t);case"blocks":return function(e,t){const n=o(e,(e=>e._courseAttainment&&e._courseAttainment._isEnabled));if(!n.length)return!1;const r=o(n,(e=>i(e._childrenIds,(e=>t[e]._isComplete))));return{_isComplete:n.length===r.length,_progress:100/n.length*r.length,contentCount:n.length}}(n,t);case"points":return function({_attainmentAttributes:e},t){const n=t&&t._points;return n&&n._isEnabled&&e?{_isComplete:n._currentPoints>=e,_progress:100/e*n._currentPoints}:{_isComplete:!1,_progress:0,contentCount:e}}(e,r);case"stars":return function({_attainmentAttributes:e},t){const n=t&&t._stars;return n&&n._isEnabled&&e?{_isComplete:n._currentStarsCollected>=e,_progress:100/e*n._currentStarsCollected}:{_isComplete:!1,_progress:0,contentCount:e}}(e,r);default:return{_isComplete:!1,_progress:0}}}e.exports=(e=m,t)=>{if(t.type===a){const n=t.payload.course._courseAttainment;return n&&n._isEnabled?r({},e,n,p(n,t.payload)):m}if(!e._isEnabled)return m;if(e._isComplete)return e;switch(t.type){case c:return"points"===e._attainmentMethod||"stars"===e._attainmentMethod?e:r({},e,p(e,t.payload));case l:return"components"===e._attainmentMethod||"blocks"===e._attainmentMethod?e:r({},e,p(e,t.payload));case s:if("courseAttainment"===t.payload.extensionName)return r({},e,t.payload.extensionData);default:return e}}},98113:e=>{e.exports={_isComplete:{fieldKey:"_isComplete",type:"Boolean",shouldRestore:!0},_progress:{fieldKey:"_progress",type:"Number",shouldRestore:!0}}},98471:(e,t,n)=>{const o=n(72579),{store:i}=n(90876);e.exports=function(e,t,n){const{course:r,theme:a}=i.getState(),s=r[e],c=o(s,t),l=o(a,["_extensions",e,"_settings",t]);return c||l||n}},6443:(e,t,n)=>{const o=n(72579),{Observable:i}=n(28761),{setLocationReadyState:r,PUSH_LOCATION:a}=n(63444),s=n(36151),c=n(69610);e.exports=(e,t)=>(n,l)=>n.filter((({type:t})=>{if(t!==a)return;const{navigationStatus:n,path:o}=l.getState().location;return"plugin"===n&&o[0]===e})).switchMap((()=>{const n=l.getState(),{device:a,course:m}=n;let p;if(p=t?t(n):o(m,[`_${e}`,"_heroImage"]),!p||!p._graphic)return i.empty();const u=s(p._graphic.src,p._graphic.srcAdvanced,!0);return u?i.concat(i.of(r(!1)),i.bindCallback(c)(u,!1).map((()=>r(!0)))):i.empty()}))}}]);